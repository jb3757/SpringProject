{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, vModelSelect as _vModelSelect, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nimport _imports_0 from '../assets/img/heart.png';\nimport _imports_1 from '../assets/img/cart2.png';\nconst _hoisted_1 = {\n  class: \"search\"\n};\nconst _hoisted_2 = {\n  class: \"search_header\"\n};\nconst _hoisted_3 = {\n  class: \"search_header_left\"\n};\nconst _hoisted_4 = {\n  class: \"search_header_right\"\n};\nconst _hoisted_5 = /*#__PURE__*/_createElementVNode(\"option\", {\n  value: \"판매순\"\n}, \"판매순\", -1 /* HOISTED */);\nconst _hoisted_6 = /*#__PURE__*/_createElementVNode(\"option\", {\n  value: \"신상품순\"\n}, \"신상품순\", -1 /* HOISTED */);\nconst _hoisted_7 = [_hoisted_5, _hoisted_6];\nconst _hoisted_8 = {\n  class: \"search_items\"\n};\nconst _hoisted_9 = {\n  class: \"search_item_img\"\n};\nconst _hoisted_10 = {\n  href: \"\"\n};\nconst _hoisted_11 = [\"src\"];\nconst _hoisted_12 = {\n  class: \"search_item_info\"\n};\nconst _hoisted_13 = {\n  class: \"best_item_info_title\"\n};\nconst _hoisted_14 = {\n  href: \"\"\n};\nconst _hoisted_15 = {\n  class: \"search_item_info_author\"\n};\nconst _hoisted_16 = {\n  class: \"search_item_info_price\"\n};\nconst _hoisted_17 = /*#__PURE__*/_createElementVNode(\"span\", null, \"원\", -1 /* HOISTED */);\nconst _hoisted_18 = {\n  class: \"best_item_info_summary\"\n};\nconst _hoisted_19 = {\n  class: \"search_item_info_star\"\n};\nconst _hoisted_20 = {\n  key: 0,\n  class: \"best_item_info_star_num\"\n};\nconst _hoisted_21 = {\n  key: 1,\n  class: \"best_item_info_star_num\"\n};\nconst _hoisted_22 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"search_item_order\"\n}, [/*#__PURE__*/_createElementVNode(\"a\", {\n  href: \"\"\n}, \"결제하러 가기\"), /*#__PURE__*/_createElementVNode(\"p\", null, [/*#__PURE__*/_createElementVNode(\"span\", null, \"내일(7/28)\"), /*#__PURE__*/_createTextVNode(\" 도착예정\")])], -1 /* HOISTED */);\nconst _hoisted_23 = {\n  class: \"search_item_btn\"\n};\nconst _hoisted_24 = /*#__PURE__*/_createElementVNode(\"img\", {\n  src: _imports_0,\n  alt: \"\"\n}, null, -1 /* HOISTED */);\nconst _hoisted_25 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_GnbBar = _resolveComponent(\"GnbBar\");\n  const _component_StarIcon = _resolveComponent(\"StarIcon\");\n  const _component_Floating = _resolveComponent(\"Floating\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createVNode(_component_GnbBar, {\n    ref: \"childComponent\",\n    onSearchKeyword: $options.handleSearchKeyword\n  }, null, 8 /* PROPS */, [\"onSearchKeyword\"]), _createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"span\", null, \"'\" + _toDisplayString($data.searchKeyword) + \"'\", 1 /* TEXT */), _createTextVNode(\"에 대한 \"), _createElementVNode(\"span\", null, _toDisplayString($data.searchListData.length), 1 /* TEXT */), _createTextVNode(\"개의 검색 결과 \")]), _createElementVNode(\"div\", _hoisted_4, [_withDirectives(_createElementVNode(\"select\", {\n    onChange: _cache[0] || (_cache[0] = (...args) => $options.getSearchList && $options.getSearchList(...args)),\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.filterValue = $event)\n  }, _hoisted_7, 544 /* HYDRATE_EVENTS, NEED_PATCH */), [[_vModelSelect, $data.filterValue]])])]), _createElementVNode(\"div\", _hoisted_8, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.searchListData, (item, i) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: i,\n      class: \"search_item\"\n    }, [_createElementVNode(\"div\", _hoisted_9, [_createElementVNode(\"a\", _hoisted_10, [_createElementVNode(\"img\", {\n      src: item.BOOK_COVER,\n      alt: \"\"\n    }, null, 8 /* PROPS */, _hoisted_11)])]), _createElementVNode(\"div\", _hoisted_12, [_createElementVNode(\"h2\", _hoisted_13, [_createElementVNode(\"a\", _hoisted_14, _toDisplayString(item.BOOK_TITLE), 1 /* TEXT */)]), _createElementVNode(\"span\", _hoisted_15, _toDisplayString(item.BOOK_AUTHOR) + \" | \" + _toDisplayString(item.BOOK_PUBDATE), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_16, [_createElementVNode(\"span\", null, _toDisplayString($options.formatNumber(item.BOOK_PRICE)), 1 /* TEXT */), _hoisted_17]), _createElementVNode(\"p\", _hoisted_18, _toDisplayString(item.BOOK_DESCRIPTION), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_19, [item.reviewpoint == 0 ? (_openBlock(), _createElementBlock(\"span\", _hoisted_20, \"0.0\")) : (_openBlock(), _createElementBlock(\"span\", _hoisted_21, _toDisplayString($options.formatReviewScore(item.reviewpoint)), 1 /* TEXT */)), _createVNode(_component_StarIcon, {\n      rating: $options.convertRatingToHalfStars($data.reviewScore[i])\n    }, null, 8 /* PROPS */, [\"rating\"])])]), _hoisted_22, _createElementVNode(\"div\", _hoisted_23, [_hoisted_24, _createElementVNode(\"img\", {\n      onClick: $event => $options.addToCart(item.BOOK_ID),\n      src: _imports_1,\n      alt: \"\"\n    }, null, 8 /* PROPS */, _hoisted_25)])]);\n  }), 128 /* KEYED_FRAGMENT */))]), _createCommentVNode(\" 플로팅\"), _createVNode(_component_Floating)])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["_imports_0","_imports_1","class","_createElementVNode","value","_hoisted_5","_hoisted_6","href","src","alt","_createVNode","_component_GnbBar","ref","onSearchKeyword","$options","handleSearchKeyword","_hoisted_1","_hoisted_2","_hoisted_3","_toDisplayString","$data","searchKeyword","searchListData","length","_hoisted_4","onChange","_cache","args","getSearchList","filterValue","$event","_hoisted_8","_createElementBlock","_Fragment","_renderList","item","i","key","_hoisted_9","_hoisted_10","BOOK_COVER","_hoisted_12","_hoisted_13","_hoisted_14","BOOK_TITLE","_hoisted_15","BOOK_AUTHOR","BOOK_PUBDATE","_hoisted_16","formatNumber","BOOK_PRICE","_hoisted_17","_hoisted_18","BOOK_DESCRIPTION","_hoisted_19","reviewpoint","_hoisted_20","_hoisted_21","formatReviewScore","_component_StarIcon","rating","convertRatingToHalfStars","reviewScore","_hoisted_22","_hoisted_23","_hoisted_24","onClick","addToCart","BOOK_ID","_createCommentVNode","_component_Floating"],"sources":["C:\\Users\\Lim\\Desktop\\BOOK_0728\\MOONMOON\\vue_front\\src\\views\\searchList.vue"],"sourcesContent":["<style src=\"../assets/css/searchList.css\"></style>\r\n\r\n<template>\r\n    <GnbBar ref=\"childComponent\" @search-keyword=\"handleSearchKeyword\" />\r\n    <div class=\"search\">\r\n        <div class=\"search_header\">\r\n            <div class=\"search_header_left\">\r\n                <span>'{{ searchKeyword }}'</span>에 대한\r\n                <span>{{ searchListData.length }}</span>개의 검색 결과\r\n            </div>\r\n            <div class=\"search_header_right\">\r\n                <select @change=\"getSearchList\" v-model=\"filterValue\">\r\n                    <option value=\"판매순\">판매순</option>\r\n                    <option value=\"신상품순\">신상품순</option>\r\n                </select>\r\n            </div>\r\n        </div>\r\n        <div class=\"search_items\">\r\n            <div v-for=\"(item, i) in searchListData\" :key=\"i\" class=\"search_item\">\r\n                <div class=\"search_item_img\">\r\n                    <a href=\"\"><img :src=\"item.BOOK_COVER\" alt=\"\" /></a>\r\n                </div>\r\n                <div class=\"search_item_info\">\r\n                    <h2 class=\"best_item_info_title\"><a href=\"\">{{ item.BOOK_TITLE }}</a></h2>\r\n                    <span class=\"search_item_info_author\">{{ item.BOOK_AUTHOR }} | {{ item.BOOK_PUBDATE }}</span>\r\n                    <div class=\"search_item_info_price\">\r\n                        <span>{{ formatNumber(item.BOOK_PRICE) }}</span>\r\n                        <span>원</span>\r\n                    </div>\r\n                    <p class=\"best_item_info_summary\">\r\n                        {{ item.BOOK_DESCRIPTION }}\r\n                    </p>\r\n                    <div class=\"search_item_info_star\">\r\n                        <span v-if=\"item.reviewpoint == 0\" class=\"best_item_info_star_num\">0.0</span>\r\n                        <span v-else class=\"best_item_info_star_num\">{{ formatReviewScore(item.reviewpoint) }}</span>\r\n                        <StarIcon :rating=\"convertRatingToHalfStars(reviewScore[i])\" />\r\n                    </div>\r\n                </div>\r\n                <div class=\"search_item_order\">\r\n                    <a href=\"\">결제하러 가기</a>\r\n                    <p><span>내일(7/28)</span> 도착예정</p>\r\n                </div>\r\n                <div class=\"search_item_btn\">\r\n                    <img src=\"../assets/img/heart.png\" alt=\"\" />\r\n                    <img @click=\"addToCart(item.BOOK_ID)\" src=\"../assets/img/cart2.png\" alt=\"\" />\r\n                </div>\r\n            </div>\r\n        </div>\r\n            <!-- 플로팅-->\r\n    <Floating />\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport GnbBar from \"../components/gnbBar.vue\";\r\nimport Floating from \"../components/floating.vue\"\r\nimport StarIcon from \"../components/star.vue\"; // 별점 아이콘 컴포넌트의 경로를 수정해주세요.\r\nimport { eventBus } from '@/main'; // 이벤트 버스 가져오기\r\n\r\nimport axios from \"axios\";\r\naxios.defaults.baseURL = \"http://localhost:3000\";\r\naxios.defaults.headers.post[\"Contents-Type\"] = \"application/json;charset=utf-8\";\r\naxios.defaults.headers.post[\"Access-Control-Allow-Origin\"] = \"*\";\r\n\r\nexport default {\r\n\r\n    name: \"\",\r\n    components: { GnbBar, StarIcon, Floating },\r\n    data() {\r\n        return {\r\n            searchListData: [],\r\n            reviewScore: [], // 리뷰 점수를 얻어온다고 가정\r\n            email: \"\",\r\n            bookId: \"\",\r\n            searchKeyword: \"\",\r\n            filterValue: \"판매순\",\r\n        };\r\n    },\r\n\r\n    setup() { },\r\n    created() {\r\n        this.email = localStorage.getItem(\"userID\");\r\n        this.getSearchList();\r\n    },\r\n    mounted() { },\r\n    unmounted() { },\r\n\r\n    methods: {\r\n        handleSearchKeyword(keyword) {\r\n            this.searchKeyword = keyword;\r\n            this.getSearchList();\r\n        },\r\n\r\n        async getSearchList() {\r\n            const userKeyword = this.$route.params.keyword;\r\n            this.searchKeyword = userKeyword;\r\n\r\n            if (this.filterValue === \"판매순\") {\r\n                try {\r\n                    const response = await axios.get(\"http://localhost:3000/main/best\", {\r\n                        params: {\r\n                            searchKeyword: userKeyword\r\n                        }\r\n                    });\r\n\r\n                    console.log(response.data);\r\n\r\n                    this.searchListData = response.data;\r\n                    for (var i in response.data) {\r\n                        this.reviewScore.push((response.data[i].reviewpoint) / 2);\r\n                    }\r\n                } catch (error) {\r\n                    console.error(\"Error fetching search results:\", error);\r\n                }\r\n            } else if (this.filterValue === \"신상품순\") {\r\n                try {\r\n                    const response = await axios.get(\"http://localhost:3000/main/new\", {\r\n                        params: {\r\n                            searchKeyword: userKeyword\r\n                        }\r\n                    });\r\n\r\n                    console.log(response.data);\r\n\r\n                    this.searchListData = response.data;\r\n                    for (var i in response.data) {\r\n                        this.reviewScore.push((response.data[i].reviewpoint) / 2);\r\n                    }\r\n                } catch (error) {\r\n                    console.error(\"Error fetching search results:\", error);\r\n                }\r\n            }\r\n\r\n\r\n\r\n        },\r\n        //입력된 숫자를 주어진 범위에 따라 적절한 별점으로 변환\r\n        convertRatingToHalfStars(number) {\r\n            if (Number.isInteger(number)) {\r\n                if (number >= 1 && number <= 5) {\r\n                    return number;\r\n                } else {\r\n                    return 0; // 범위를 벗어나는 경우\r\n                }\r\n            } else {\r\n                const integerPart = Math.floor(number);\r\n                const decimalPart = number - integerPart;\r\n\r\n                if (decimalPart < 0.5) {\r\n                    return integerPart;\r\n                } else {\r\n                    return integerPart + 0.5;\r\n                }\r\n            }\r\n        },\r\n        formatReviewScore(number) {\r\n            if (Number.isInteger(number)) {\r\n                return number.toFixed(1); // 정수인 경우 소수점 자리를 1로 설정하여 변환\r\n            } else {\r\n                return number.toString(); // 소수인 경우 그대로 문자열로 변환\r\n            }\r\n        },\r\n        formatNumber(number) {\r\n            // 숫자를 천 단위마다 쉼표가 있는 형식으로 변환\r\n            return new Intl.NumberFormat().format(number);\r\n        },\r\n        //장바구니에 추가\r\n        async addToCart(bookId) {\r\n            this.bookId = bookId;\r\n            await axios({\r\n                url: \"http://localhost:3000/detail/gotoCart\",\r\n                method: \"POST\",\r\n                data: {\r\n                    email: this.email,\r\n                    bookId: this.bookId\r\n                }\r\n            })\r\n                .then((res) => {\r\n                    alert(\"장바구니에 추가되었습니다.\");\r\n                    this.$refs.childComponent.getCartNum();\r\n                })\r\n        },\r\n    },\r\n};\r\n</script>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}