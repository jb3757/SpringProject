{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, vModelSelect as _vModelSelect, withDirectives as _withDirectives, vShow as _vShow, vModelText as _vModelText, mergeProps as _mergeProps } from \"vue\";\nconst _hoisted_1 = {\n  class: \"payment_total_ex\"\n};\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"payment_title\"\n}, \"주문/결제\", -1 /* HOISTED */);\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"progress\"\n}, [/*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"before\"\n}, [/*#__PURE__*/_createTextVNode(\"장바구니> \"), /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"now\"\n}, \"주문/결제\"), /*#__PURE__*/_createTextVNode(\"> 완료 \")])], -1 /* HOISTED */);\nconst _hoisted_4 = {\n  class: \"user_info\"\n};\nconst _hoisted_5 = {\n  class: \"payment_date\"\n};\nconst _hoisted_6 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"info1\"\n}, \"배송지 정보\", -1 /* HOISTED */);\nconst _hoisted_7 = {\n  class: \"info2\"\n};\nconst _hoisted_8 = {\n  class: \"user_add\"\n};\nconst _hoisted_9 = {\n  class: \"user_info1\"\n};\nconst _hoisted_10 = {\n  class: \"user_name\"\n};\nconst _hoisted_11 = /*#__PURE__*/_createElementVNode(\"span\", null, \" / \", -1 /* HOISTED */);\nconst _hoisted_12 = {\n  class: \"user_phone\"\n};\nconst _hoisted_13 = {\n  class: \"user_add_detail\"\n};\nconst _hoisted_14 = {\n  class: \"payment_book_info\"\n};\nconst _hoisted_15 = /*#__PURE__*/_createElementVNode(\"colgroup\", null, [/*#__PURE__*/_createElementVNode(\"col\")], -1 /* HOISTED */);\nconst _hoisted_16 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"text\"\n}, \"주문 상품\", -1 /* HOISTED */);\nconst _hoisted_17 = {\n  class: \"num\"\n};\nconst _hoisted_18 = {\n  class: \"prod\"\n};\nconst _hoisted_19 = {\n  class: \"prod_area horizontal\"\n};\nconst _hoisted_20 = {\n  class: \"prod_thumb_box size_sm\"\n};\nconst _hoisted_21 = {\n  class: \"img_box\"\n};\nconst _hoisted_22 = [\"src\", \"alt\"];\nconst _hoisted_23 = {\n  class: \"prod_info_box\"\n};\nconst _hoisted_24 = {\n  class: \"prod_info\"\n};\nconst _hoisted_25 = {\n  class: \"prod_name\"\n};\nconst _hoisted_26 = {\n  class: \"book_price\"\n};\nconst _hoisted_27 = {\n  class: \"book_q\"\n};\nconst _hoisted_28 = {\n  class: \"book_total\"\n};\nconst _hoisted_29 = {\n  class: \"use_coupon\"\n};\nconst _hoisted_30 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"coupon_text\"\n}, \"할인 쿠폰\", -1 /* HOISTED */);\nconst _hoisted_31 = /*#__PURE__*/_createElementVNode(\"option\", {\n  disabled: \"\",\n  value: \"\"\n}, \"쿠폰을 선택하세요\", -1 /* HOISTED */);\nconst _hoisted_32 = [\"value\"];\nconst _hoisted_33 = {\n  class: \"use_point\"\n};\nconst _hoisted_34 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"point_text\"\n}, \"포인트\", -1 /* HOISTED */);\nconst _hoisted_35 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"user_havePoint\"\n}, \"보유 포인트 :  \", -1 /* HOISTED */);\nconst _hoisted_36 = {\n  class: \"user_point\"\n};\nconst _hoisted_37 = {\n  class: \"pay_area_ex\"\n};\nconst _hoisted_38 = {\n  class: \"pay_wrap_ex\"\n};\nconst _hoisted_39 = {\n  class: \"pay_before\"\n};\nconst _hoisted_40 = /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"pay_text\"\n}, \"상품 금액\", -1 /* HOISTED */);\nconst _hoisted_41 = {\n  class: \"won_ex\"\n};\nconst _hoisted_42 = {\n  class: \"pay_fee\"\n};\nconst _hoisted_43 = /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"pay_text\"\n}, \"배송비\", -1 /* HOISTED */);\nconst _hoisted_44 = {\n  class: \"pay_usePoint\"\n};\nconst _hoisted_45 = /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"pay_text\"\n}, \"할인 금액\", -1 /* HOISTED */);\nconst _hoisted_46 = /*#__PURE__*/_createElementVNode(\"hr\", null, null, -1 /* HOISTED */);\nconst _hoisted_47 = {\n  class: \"pay_after\"\n};\nconst _hoisted_48 = /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"pay_text\"\n}, \"결제 금액\", -1 /* HOISTED */);\nconst _hoisted_49 = {\n  class: \"pay_getPoint\"\n};\nconst _hoisted_50 = /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"pay_text\"\n}, \"총 적립 포인트\", -1 /* HOISTED */);\nconst _hoisted_51 = {\n  class: \"pay_button_wrap\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_gnbBar = _resolveComponent(\"gnbBar\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_createVNode(_component_gnbBar), _createElementVNode(\"div\", _hoisted_1, [_hoisted_2, _hoisted_3, _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_hoisted_6, _createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"span\", null, \"내일(\" + _toDisplayString($data.month) + \"/\" + _toDisplayString($data.nextDay) + \")\", 1 /* TEXT */), _createTextVNode(\" 도착 예정 \")])]), _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"div\", _hoisted_9, [_createElementVNode(\"div\", _hoisted_10, _toDisplayString($data.user_name), 1 /* TEXT */), _hoisted_11, _createElementVNode(\"div\", _hoisted_12, _toDisplayString($data.user_phone), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_13, [_createTextVNode(_toDisplayString($data.user_zipcode) + \" \" + _toDisplayString($data.user_add1) + \" \" + _toDisplayString($data.user_add2) + \" \", 1 /* TEXT */), _createCommentVNode(\" 임시 삭제 <button type=\\\"button\\\" @click=\\\"openAdd\\\">변경</button> \")])])]), _createElementVNode(\"div\", _hoisted_14, [_createElementVNode(\"table\", null, [_hoisted_15, _createElementVNode(\"thead\", null, [_createElementVNode(\"th\", null, [_hoisted_16, _createElementVNode(\"div\", _hoisted_17, \"총 \" + _toDisplayString($data.count) + \" 개\", 1 /* TEXT */)])]), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.books, book => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: book.id\n    }, [_createElementVNode(\"td\", _hoisted_18, [_createElementVNode(\"div\", _hoisted_19, [_createElementVNode(\"div\", _hoisted_20, [_createElementVNode(\"span\", _hoisted_21, [_createElementVNode(\"img\", {\n      src: book.image,\n      alt: book.name\n    }, null, 8 /* PROPS */, _hoisted_22)])]), _createElementVNode(\"div\", _hoisted_23, [_createElementVNode(\"div\", _hoisted_24, [_createElementVNode(\"div\", _hoisted_25, _toDisplayString(book.name), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_26, _toDisplayString($options.comma(book.price)) + \"원\", 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_27, _toDisplayString(book.quantity) + \"개\", 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_28, _toDisplayString($options.comma(book.totalPrice)) + \"원\", 1 /* TEXT */)])])])])]);\n  }), 128 /* KEYED_FRAGMENT */))])])]), _createElementVNode(\"div\", _hoisted_29, [_hoisted_30, _withDirectives(_createElementVNode(\"select\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.selectedCoupon = $event),\n    class: \"choice_coupon\"\n  }, [_hoisted_31, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.coupons, coupon => {\n    return _openBlock(), _createElementBlock(\"option\", {\n      key: coupon.name,\n      value: coupon.ratio\n    }, _toDisplayString(coupon.name), 9 /* TEXT, PROPS */, _hoisted_32);\n  }), 128 /* KEYED_FRAGMENT */))], 512 /* NEED_PATCH */), [[_vModelSelect, $data.selectedCoupon]]), _createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.applyCoupon && $options.applyCoupon(...args))\n  }, \"사용\"), _withDirectives(_createElementVNode(\"button\", {\n    onClick: _cache[2] || (_cache[2] = (...args) => $options.cancelCoupon && $options.cancelCoupon(...args))\n  }, \"취소\", 512 /* NEED_PATCH */), [[_vShow, $data.useCoupon]])]), _createElementVNode(\"div\", _hoisted_33, [_hoisted_34, _withDirectives(_createElementVNode(\"input\", {\n    type: \"number\",\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $data.usePoint = $event)\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.usePoint]]), _createElementVNode(\"button\", {\n    onClick: _cache[4] || (_cache[4] = (...args) => $options.applyPoint && $options.applyPoint(...args))\n  }, \"사용\"), _hoisted_35, _createElementVNode(\"div\", _hoisted_36, _toDisplayString(this.point) + \" P\", 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_37, [_createElementVNode(\"div\", _hoisted_38, [_createElementVNode(\"div\", _hoisted_39, [_hoisted_40, _createElementVNode(\"span\", _hoisted_41, _toDisplayString($options.comma($data.originalPrice)) + \" 원\", 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_42, [_hoisted_43, _createElementVNode(\"span\", _mergeProps({\n    class: \"won_ex\"\n  }, $options.calDeliveryFee), _toDisplayString($options.comma(this.deliveryFee)) + \" 원\", 17 /* TEXT, FULL_PROPS */)]), _createElementVNode(\"div\", _hoisted_44, [_hoisted_45, _createElementVNode(\"span\", _mergeProps({\n    class: \"point\"\n  }, $options.calDiscountAmount), \"- \" + _toDisplayString($options.comma(this.discountAmount)) + \" 원\", 17 /* TEXT, FULL_PROPS */)]), _hoisted_46, _createElementVNode(\"div\", _hoisted_47, [_hoisted_48, _createElementVNode(\"span\", _mergeProps({\n    class: \"won_ex\"\n  }, $options.calFinalPrice), _toDisplayString($options.comma(this.finalPrice)) + \" 원\", 17 /* TEXT, FULL_PROPS */)]), _createElementVNode(\"div\", _hoisted_49, [_hoisted_50, _createElementVNode(\"span\", _mergeProps({\n    class: \"won_ex\"\n  }, $options.calEarnPoint), _toDisplayString(this.earnPoint) + \" P\", 17 /* TEXT, FULL_PROPS */)]), _createElementVNode(\"div\", _hoisted_51, [_createElementVNode(\"button\", {\n    class: \"pay_button_ex\",\n    type: \"button\",\n    onClick: _cache[5] || (_cache[5] = (...args) => $options.startPay && $options.startPay(...args))\n  }, \"결제하러 가기\")])])])])]);\n}","map":{"version":3,"names":["class","_createElementVNode","disabled","value","_createElementBlock","_createVNode","_component_gnbBar","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_toDisplayString","$data","month","nextDay","_hoisted_8","_hoisted_9","_hoisted_10","user_name","_hoisted_11","_hoisted_12","user_phone","_hoisted_13","user_zipcode","user_add1","user_add2","_createCommentVNode","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","count","_Fragment","_renderList","books","book","key","id","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","src","image","alt","name","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","$options","comma","price","_hoisted_27","quantity","_hoisted_28","totalPrice","_hoisted_29","_hoisted_30","selectedCoupon","$event","_hoisted_31","coupons","coupon","ratio","_hoisted_32","onClick","_cache","args","applyCoupon","cancelCoupon","useCoupon","_hoisted_33","_hoisted_34","type","usePoint","applyPoint","_hoisted_35","_hoisted_36","point","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","originalPrice","_hoisted_42","_hoisted_43","_mergeProps","calDeliveryFee","deliveryFee","_hoisted_44","_hoisted_45","calDiscountAmount","discountAmount","_hoisted_46","_hoisted_47","_hoisted_48","calFinalPrice","finalPrice","_hoisted_49","_hoisted_50","calEarnPoint","earnPoint","_hoisted_51","startPay"],"sources":["C:\\Users\\bj375\\Documents\\workspace-sts-3.9.18.RELEASE\\Moonmoon\\vue_front\\src\\views\\pay.vue"],"sourcesContent":["<style src=\"../assets/css/pay.css\"></style>\r\n<template>\r\n    <div>\r\n        <gnbBar />\r\n        <div class=\"payment_total_ex\">\r\n            <div class=\"payment_title\">주문/결제</div>\r\n            <div class=\"progress\">\r\n                <span class=\"before\">장바구니> <span class=\"now\">주문/결제</span>> 완료 </span>\r\n            </div>\r\n            <div class=\"user_info\">\r\n                <div class=\"payment_date\">\r\n                    <div class=\"info1\">배송지 정보</div>\r\n                    <div class=\"info2\">\r\n                        <span>내일({{ month }}/{{ nextDay }})</span> 도착 예정\r\n                    </div>\r\n                </div>\r\n                <div class=\"user_add\">\r\n                    <div class=\"user_info1\">\r\n                        <div class=\"user_name\">{{ user_name }}</div>\r\n                        <span> / </span>\r\n                        <div class=\"user_phone\">{{ user_phone }}</div>\r\n                    </div>\r\n                    <div class=\"user_add_detail\">\r\n                        {{ user_zipcode }} {{ user_add1 }} {{ user_add2 }}\r\n                        <!-- 임시 삭제 <button type=\"button\" @click=\"openAdd\">변경</button> -->\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"payment_book_info\">\r\n                <table>\r\n                    <colgroup>\r\n                        <col />\r\n                    </colgroup>\r\n                    <thead>\r\n                        <th>\r\n                            <div class=\"text\">주문 상품</div>\r\n                            <div class=\"num\">총 {{ count }} 개</div>\r\n                        </th>\r\n                    </thead>\r\n\r\n                    <tbody>\r\n                        <tr v-for=\"book in books\" :key=\"book.id\">\r\n                            <td class=\"prod\">\r\n                                <div class=\"prod_area horizontal\">\r\n                                    <div class=\"prod_thumb_box size_sm\">\r\n                                        <span class=\"img_box\">\r\n                                            <img :src=\"book.image\" :alt=\"book.name\" />\r\n                                        </span>\r\n                                    </div>\r\n                                    <div class=\"prod_info_box\">\r\n                                        <div class=\"prod_info\">\r\n                                            <div class=\"prod_name\">{{ book.name }}</div>\r\n                                            <div class=\"book_price\">{{ comma(book.price) }}원</div>\r\n                                            <div class=\"book_q\">{{ book.quantity }}개</div>\r\n                                            <div class=\"book_total\">{{ comma(book.totalPrice) }}원</div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n            <div class=\"use_coupon\">\r\n                <div class=\"coupon_text\">할인 쿠폰</div>\r\n                <select v-model=\"selectedCoupon\" class=\"choice_coupon\">\r\n                    <option disabled value=\"\">쿠폰을 선택하세요</option>\r\n                    <option v-for=\"coupon in coupons\" :key=\"coupon.name\" :value=\"coupon.ratio\">\r\n                        {{ coupon.name }}\r\n                    </option>\r\n                </select>\r\n                <button @click=\"applyCoupon\">사용</button>\r\n                <button v-show=\"useCoupon\" @click=\"cancelCoupon\">취소</button>\r\n            </div>\r\n            <div class=\"use_point\">\r\n                <div class=\"point_text\">포인트</div>\r\n                <input type=\"number\" v-model=\"usePoint\" />\r\n                <button @click=\"applyPoint\">사용</button>\r\n                <div class=\"user_havePoint\">보유 포인트 : &nbsp;</div>\r\n                <div class=\"user_point\">{{ this.point }} P</div>\r\n            </div>\r\n            <div class=\"pay_area_ex\">\r\n                <div class=\"pay_wrap_ex\">\r\n                    <div class=\"pay_before\">\r\n                        <span class=\"pay_text\">상품 금액</span>\r\n                        <span class=\"won_ex\">{{ comma(originalPrice) }} 원</span>\r\n                    </div>\r\n                    <div class=\"pay_fee\">\r\n                        <span class=\"pay_text\">배송비</span>\r\n                        <span class=\"won_ex\" v-bind=\"calDeliveryFee\">{{ comma(this.deliveryFee) }} 원</span>\r\n                    </div>\r\n                    <div class=\"pay_usePoint\">\r\n                        <span class=\"pay_text\">할인 금액</span>\r\n                        <span class=\"point\" v-bind=\"calDiscountAmount\">- {{ comma(this.discountAmount) }} 원</span>\r\n                    </div>\r\n                    <hr />\r\n                    <div class=\"pay_after\">\r\n                        <span class=\"pay_text\">결제 금액</span>\r\n                        <span class=\"won_ex\" v-bind=\"calFinalPrice\">{{ comma(this.finalPrice) }} 원</span>\r\n                    </div>\r\n                    <div class=\"pay_getPoint\">\r\n                        <span class=\"pay_text\">총 적립 포인트</span>\r\n                        <span class=\"won_ex\" v-bind=\"calEarnPoint\">{{ this.earnPoint }} P</span>\r\n                    </div>\r\n                    <div class=\"pay_button_wrap\">\r\n                        <button class=\"pay_button_ex\" type=\"button\" @click=\"startPay\">결제하러 가기</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport gnbBar from \"@/components/gnbBar.vue\";\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n    components: { gnbBar },\r\n    data() {\r\n        return {\r\n            user_name: \"\",\r\n            user_phone: \"\",\r\n            user_zipcode: \"\",\r\n            user_add1: \"\",\r\n            user_add2: \"\",\r\n            user_email: ``,\r\n            books: [],\r\n            count: \"\",\r\n            coupons: [],\r\n            point: 0,\r\n            oldPoint: 0,\r\n            nextDay: \"\",\r\n            month: \"\",\r\n            selectedCoupon: \"\",\r\n            usePoint: 0,\r\n            isModalOpen: true,\r\n            useCoupon: false,\r\n            payID: this.$route.query.payid,\r\n            userEmail: localStorage.getItem(\"userID\"),\r\n            originalPrice: 0,\r\n            deliveryFee: 0,\r\n            discountAmount: 0,\r\n            dfCalPrice: 0,\r\n            finalPrice: 0,\r\n            earnPoint: 0,\r\n            applyCouponPrice: 0,\r\n            applyPointPrice: 0,\r\n            realTimePoint: 0,\r\n        };\r\n    },\r\n    mounted() {\r\n        this.getNextDate();\r\n        this.getUserInfo();\r\n        this.getBookCount();\r\n        this.getBookInfo();\r\n        this.getCouponList();\r\n        this.getUserPoint();\r\n        this.getOriginalPrice();\r\n        this.checkState();\r\n\r\n        console.log(this.$route.query.payid);\r\n        console.log(this.payID);\r\n    },\r\n    computed: {\r\n        calDiscountAmount() {\r\n            this.discountAmount = this.applyCouponPrice + this.applyPointPrice;\r\n            console.log(\"discountAmount:\", this.discountAmount);\r\n        },\r\n        calDeliveryFee() {\r\n            this.dfCalPrice = this.originalPrice - this.discountAmount;\r\n            console.log(\"dfCalPrice:\", this.dfCalPrice);\r\n\r\n            if (this.dfCalPrice < 50000) {\r\n                this.deliveryFee = 2500;\r\n            } else {\r\n                this.deliveryFee = 0;\r\n            }\r\n        },\r\n        calEarnPoint() {\r\n            if (this.usePoint > this.dfCalPrice) {\r\n                this.earnPoint = 0;\r\n            } else {\r\n                this.earnPoint = Math.floor(this.dfCalPrice * 0.05);\r\n            }\r\n        },\r\n        calFinalPrice() {\r\n            this.finalPrice = this.originalPrice - this.discountAmount + this.deliveryFee;\r\n        },\r\n    },\r\n    methods: {\r\n        getUserInfo() {\r\n            const email = this.userEmail;\r\n\r\n            axios({\r\n                url: \"/pay/payUserInfo\",\r\n                method: \"post\",\r\n                data: { userEmail: email },\r\n            }).then((res) => {\r\n                this.user_name = res.data[0].USER_NAME;\r\n                this.user_phone = res.data[0].USER_PHONE;\r\n                this.user_zipcode = res.data[0].USER_ZIPCODE;\r\n                this.user_add1 = res.data[0].USER_ADD1;\r\n                this.user_add2 = res.data[0].USER_ADD2;\r\n            });\r\n        },\r\n        getNextDate() {\r\n            //내일 배송일로 나오게 하는 함수\r\n            const today = new Date();\r\n            this.nextDay = today.getDate() + 1;\r\n            this.month = today.getMonth() + 1;\r\n        },\r\n        getBookCount() {\r\n            const payid = this.payID;\r\n\r\n            axios({\r\n                url: \"/pay/bookCount\",\r\n                method: \"get\",\r\n                params: { payID: [payid] },\r\n            }).then((res) => {\r\n                this.count = res.data[0].ORDERITEM_CNT;\r\n            });\r\n        },\r\n        getBookInfo() {\r\n            const payid = this.payID;\r\n\r\n            axios({\r\n                url: \"/pay/payBookInfo\",\r\n                method: \"post\",\r\n                data: { payID: [payid] },\r\n            }).then((res) => {\r\n                this.books = res.data;\r\n                console.log(this.books);\r\n            });\r\n        },\r\n        getCouponList() {\r\n            const email = this.userEmail;\r\n\r\n            axios({\r\n                url: \"/pay/couponList\",\r\n                method: \"get\",\r\n                params: { userEmail: email },\r\n            }).then((res) => {\r\n                this.coupons = res.data;\r\n                console.log(\"coupons:\", res.data);\r\n            });\r\n        },\r\n        goUsedCoupon() {\r\n            const usedCoupon = {\r\n                selectedCoupon: this.selectedCoupon,\r\n                userEmail: this.userEmail,\r\n            };\r\n\r\n            axios({\r\n                url: \"/pay/usedCouponStatusChange\",\r\n                method: \"get\",\r\n                params: usedCoupon,\r\n            }).then((res) => {\r\n                console.log(\"gocouponsuccess\");\r\n            });\r\n        },\r\n        applyCoupon() {\r\n            console.log(\"selectedCoupon:\", this.selectedCoupon);\r\n            console.log(\"coupons:\", this.coupons);\r\n            this.useCoupon = true;\r\n            console.log(this.useCoupon);\r\n\r\n            if (this.selectedCoupon === 5) {\r\n                const selectedCouponRatio = 0.05;\r\n                this.applyCouponPrice = this.originalPrice * selectedCouponRatio;\r\n            } else if (this.selectedCoupon === 10) {\r\n                const selectedCouponRatio = 0.1;\r\n                this.applyCouponPrice = this.originalPrice * selectedCouponRatio;\r\n            } else if (this.selectedCoupon === 15) {\r\n                const selectedCouponRatio = 0.15;\r\n                this.applyCouponPrice = this.originalPrice * selectedCouponRatio;\r\n            } else if (this.selectedCoupon === 20) {\r\n                const selectedCouponRatio = 0.2;\r\n                this.applyCouponPrice = this.originalPrice * selectedCouponRatio;\r\n            } else if (this.selectedCoupon === 0) {\r\n                const selectedCouponRatio = 0;\r\n                this.deliveryFee = 0;\r\n                this.applyCouponPrice = this.originalPrice * selectedCouponRatio;\r\n            } else {\r\n                this.applyCouponPrice = this.originalPrice;\r\n            }\r\n            console.log(\"applyCouponPrice:\", this.applyCouponPrice);\r\n        },\r\n        getUserPoint() {\r\n            const email = this.userEmail;\r\n\r\n            axios({\r\n                url: \"/pay/userPoint\",\r\n                method: \"get\",\r\n                params: { userEmail: email },\r\n            }).then((res) => {\r\n                this.point = res.data[0].USER_POINT;\r\n                this.oldPoint = res.data[0].USER_POINT;\r\n            });\r\n        },\r\n        goUsedPoint() {\r\n            const usedPoint = {\r\n                applyPointPrice: this.applyPointPrice,\r\n                userEmail: this.userEmail,\r\n            };\r\n            axios({\r\n                url: \"/pay/delUsedPoint\",\r\n                method: \"get\",\r\n                params: usedPoint,\r\n            }).then((res) => {\r\n                console.log(\"gocpointsuccess\");\r\n            });\r\n        },\r\n        applyPoint() {\r\n            console.log(\"usePoint = \" + this.usePoint);\r\n\r\n            if (this.usePoint > this.oldPoint) {\r\n                alert(\"보유 포인트보다 많은 포인트를 사용할 수 없습니다.\");\r\n            } else {\r\n                const previouslyUsedPoint = this.applyPointPrice;\r\n                this.applyPointPrice = this.usePoint;\r\n                this.point = this.point + previouslyUsedPoint - this.applyPointPrice;\r\n            }\r\n            console.log(\"applyPointPrice:\", this.applyPointPrice);\r\n        },\r\n        getOriginalPrice() {\r\n            const payid = this.payID;\r\n\r\n            axios({\r\n                url: \"/pay/originalPrice\",\r\n                method: \"get\",\r\n                params: { payID: [payid] },\r\n            }).then((res) => {\r\n                this.originalPrice = res.data[0].oP;\r\n            });\r\n        },\r\n        /* goPriceData() {\r\n            const priceData = {\r\n                finalPrice: this.finalPrice,\r\n                deliveryFee: this.deliveryFee,\r\n                applyCouponPrice: this.applyCouponPrice,\r\n                applyPointPrice: this.applyPointPrice,\r\n                earnPoint: this.earnPoint,\r\n                payID: this.payID\r\n            };\r\n\r\n            axios({\r\n                url: \"/pay/updatePriceData\",\r\n                method: \"post\",\r\n                data: priceData,\r\n            }).then((res) => {\r\n                console.log('success');\r\n            });\r\n        },  */\r\n        openAdd() {\r\n            const confmKey = \"devU01TX0FVVEgyMDIzMDgyMjExMTQyODExNDAzODg=\";\r\n            const returnUrl = \"http://localhost:8080/pay\";\r\n            const resultType = \"4\";\r\n            const useDetailAddr = \"N\";\r\n\r\n            // 주소검색 팝업 API 호출 URL을 생성합니다.\r\n            const apiUrl = `https://business.juso.go.kr/addrlink/addrLinkUrl.do?confmKey=${confmKey}&returnUrl=${returnUrl}&resultType=${resultType}&useDetailAddr=${useDetailAddr}`;\r\n\r\n            // 팝업창을 엽니다.\r\n            window.open(apiUrl, \"주소검색팝업\", \"width=570, height=420, toolbar=no, menubar=no, scrollbars=yes, resizable=no\");\r\n        },\r\n\r\n        startPay() {\r\n            const IMP = window.IMP;\r\n            IMP.init(\"imp18828153\");\r\n            IMP.request_pay(\r\n                {\r\n                    // param\r\n                    pg: \"inicis\",\r\n                    pay_method: \"card\",\r\n                    name: this.getBookNames(),\r\n                    amount: `${this.finalPrice}`, //결제 금액\r\n                    buyer_email: `${this.user_email}`,\r\n                    buyer_name: `${this.user_name}`,\r\n                    buyer_tel: `${this.user_phone}`,\r\n                    buyer_addr: `${this.user_add1} ${this.user_add2}`,\r\n                },\r\n                (rsp) => {\r\n                    // callback\r\n                    if (rsp.success) {\r\n                        console.log(rsp.success);\r\n                        let paytype = \"\";\r\n                        if (rsp.card_name === null) {\r\n                            paytype = \"페이\";\r\n                        } else {\r\n                            paytype = rsp.card_name;\r\n                        }\r\n                        const priceData = {\r\n                            originalPrice: this.originalPrice,\r\n                            deliveryFee: this.deliveryFee,\r\n                            applyCouponPrice: this.applyCouponPrice,\r\n                            applyPointPrice: this.applyPointPrice,\r\n                            earnPoint: this.earnPoint,\r\n                            payID: this.payID,\r\n                            payMethod: paytype,\r\n                            payState: \"배송준비\",\r\n                            payCount: this.count,\r\n                        };\r\n\r\n                        axios({\r\n                            url: \"/pay/updatePriceData\",\r\n                            method: \"post\",\r\n                            data: priceData,\r\n                        })\r\n                            .then((res) => {\r\n                                this.goUsedCoupon();\r\n                            })\r\n                            .then((res) => {\r\n                                this.goUsedPoint();\r\n                            })\r\n\r\n                            .then((res) => {\r\n                                if (this.$route.query.usecart) {\r\n                                    axios({\r\n                                        url: \"/cart/allDelete\",\r\n                                        method: \"POST\",\r\n                                        data: { email: localStorage.getItem(\"userID\") },\r\n                                    }).then(() => {\r\n                                        this.$router.push({ name: \"resultpage\", query: { payid: this.payID } });\r\n                                    });\r\n                                } else {\r\n                                    this.$router.push({ name: \"resultpage\", query: { payid: this.payID } });\r\n                                }\r\n                                alert(\"결제가 완료되었습니다.\");\r\n                            });\r\n                    } else {\r\n                        console.log(rsp);\r\n                        alert(\"결제에 실패하였습니다.\");\r\n                    }\r\n                }\r\n            );\r\n        },\r\n        getBookNames() {\r\n            const payName = `${this.books[0].name} ...외 ${this.count - 1} 개`;\r\n            return payName;\r\n        },\r\n        cancelCoupon() {\r\n            this.useCoupon = false;\r\n            this.selectedCoupon = \"\"; // 선택된 쿠폰 초기화\r\n            this.applyCouponPrice = 0; // 쿠폰 적용 가격 초기화\r\n        },\r\n        comma(num) {\r\n            return String(num).replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n        },\r\n        checkState() {\r\n            console.log(this.payID);\r\n\r\n            axios({\r\n                url: \"/pay/checkS\",\r\n                method: \"POST\",\r\n                data: { bookid: this.payID },\r\n            })\r\n                .then((res) => {\r\n                    if (res.data === \"정상접근\") {\r\n                        console.log(\"ok\");\r\n                        return;\r\n                    } else {\r\n                        alert(\"잘못된 접근입니다.\");\r\n                        window.location.href = \"/\";\r\n                    }\r\n                })\r\n                .catch((err) => {\r\n                    console.log(err);\r\n                });\r\n        },\r\n    },\r\n};\r\n</script>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}