{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, createCommentVNode as _createCommentVNode } from \"vue\";\nimport _imports_0 from '../assets/img/heartFill.png';\nimport _imports_1 from '../assets/img/heart.png';\nimport _imports_2 from '../assets/img/cart2.png';\nconst _hoisted_1 = {\n  class: \"best\"\n};\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"best_header\"\n}, [/*#__PURE__*/_createElementVNode(\"h2\", null, \"BEST\")], -1 /* HOISTED */);\nconst _hoisted_3 = {\n  class: \"best_items\"\n};\nconst _hoisted_4 = {\n  class: \"best_item_img\"\n};\nconst _hoisted_5 = {\n  href: \"\"\n};\nconst _hoisted_6 = [\"src\"];\nconst _hoisted_7 = {\n  class: \"best_item_info\"\n};\nconst _hoisted_8 = {\n  class: \"best_item_info_title\"\n};\nconst _hoisted_9 = {\n  class: \"best_item_info_author\"\n};\nconst _hoisted_10 = {\n  class: \"best_item_info_price\"\n};\nconst _hoisted_11 = /*#__PURE__*/_createElementVNode(\"span\", null, \"원\", -1 /* HOISTED */);\nconst _hoisted_12 = {\n  class: \"best_item_info_summary\"\n};\nconst _hoisted_13 = {\n  class: \"best_item_info_star\"\n};\nconst _hoisted_14 = {\n  key: 0,\n  class: \"best_item_info_star_num\"\n};\nconst _hoisted_15 = {\n  key: 1,\n  class: \"best_item_info_star_num\"\n};\nconst _hoisted_16 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"best_item_order\"\n}, [/*#__PURE__*/_createElementVNode(\"a\", {\n  href: \"\"\n}, \"결제하러 가기\"), /*#__PURE__*/_createElementVNode(\"p\", null, [/*#__PURE__*/_createElementVNode(\"span\", null, \"내일(7/28)\"), /*#__PURE__*/_createTextVNode(\" 도착예정\")])], -1 /* HOISTED */);\nconst _hoisted_17 = {\n  class: \"best_item_btn\"\n};\nconst _hoisted_18 = [\"onClick\"];\nconst _hoisted_19 = [\"onClick\"];\nconst _hoisted_20 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_GnbBar = _resolveComponent(\"GnbBar\");\n  const _component_router_link = _resolveComponent(\"router-link\");\n  const _component_StarIcon = _resolveComponent(\"StarIcon\");\n  const _component_Floating = _resolveComponent(\"Floating\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createVNode(_component_GnbBar, {\n    ref: \"childComponent\"\n  }, null, 512 /* NEED_PATCH */), _createElementVNode(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"div\", _hoisted_3, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.bestListData, (item, i) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: i,\n      class: \"best_item\"\n    }, [_createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"a\", _hoisted_5, [_createElementVNode(\"img\", {\n      src: item.BOOK_COVER,\n      alt: \"\"\n    }, null, 8 /* PROPS */, _hoisted_6)])]), _createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"h2\", _hoisted_8, [_createVNode(_component_router_link, {\n      to: {\n        name: 'bookDetail',\n        params: {\n          bookNum: item.BOOK_ID\n        }\n      }\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString(item.BOOK_TITLE), 1 /* TEXT */)]),\n\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"to\"])]), _createElementVNode(\"span\", _hoisted_9, _toDisplayString(item.BOOK_AUTHOR) + \" | \" + _toDisplayString(item.BOOK_PUBDATE), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"span\", null, _toDisplayString($options.formatNumber(item.BOOK_PRICE)), 1 /* TEXT */), _hoisted_11]), _createElementVNode(\"p\", _hoisted_12, _toDisplayString(item.BOOK_DESCRIPTION), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_13, [item.reviewpoint == 0 ? (_openBlock(), _createElementBlock(\"span\", _hoisted_14, \"0.0\")) : (_openBlock(), _createElementBlock(\"span\", _hoisted_15, _toDisplayString($options.formatReviewScore(item.reviewpoint)), 1 /* TEXT */)), _createVNode(_component_StarIcon, {\n      rating: $options.convertRatingToHalfStars($data.reviewScore[i])\n    }, null, 8 /* PROPS */, [\"rating\"])])]), _hoisted_16, _createElementVNode(\"div\", _hoisted_17, [item.isLiked == true ? (_openBlock(), _createElementBlock(\"img\", {\n      key: 0,\n      onClick: $event => $options.likeToggle(item.BOOK_ID),\n      src: _imports_0,\n      alt: \"Heart Filled\"\n    }, null, 8 /* PROPS */, _hoisted_18)) : item.isLiked == false ? (_openBlock(), _createElementBlock(\"img\", {\n      key: 1,\n      onClick: $event => $options.likeToggle(item.BOOK_ID),\n      src: _imports_1,\n      alt: \"Heart\"\n    }, null, 8 /* PROPS */, _hoisted_19)) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"img\", {\n      onClick: $event => $options.addToCart(item.BOOK_ID),\n      src: _imports_2,\n      alt: \"\"\n    }, null, 8 /* PROPS */, _hoisted_20)])]);\n  }), 128 /* KEYED_FRAGMENT */))]), _createCommentVNode(\" 플로팅\"), _createVNode(_component_Floating)])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["_imports_0","_imports_1","_imports_2","class","_createElementVNode","href","_createVNode","_component_GnbBar","ref","_hoisted_1","_hoisted_2","_hoisted_3","_createElementBlock","_Fragment","_renderList","$data","bestListData","item","i","key","_hoisted_4","_hoisted_5","src","BOOK_COVER","alt","_hoisted_7","_hoisted_8","_component_router_link","to","name","params","bookNum","BOOK_ID","BOOK_TITLE","_hoisted_9","_toDisplayString","BOOK_AUTHOR","BOOK_PUBDATE","_hoisted_10","$options","formatNumber","BOOK_PRICE","_hoisted_11","_hoisted_12","BOOK_DESCRIPTION","_hoisted_13","reviewpoint","_hoisted_14","_hoisted_15","formatReviewScore","_component_StarIcon","rating","convertRatingToHalfStars","reviewScore","_hoisted_16","_hoisted_17","isLiked","onClick","$event","likeToggle","addToCart","_createCommentVNode","_component_Floating"],"sources":["C:\\Users\\Lim\\Desktop\\BOOK_0728\\MOONMOON\\vue_front\\src\\views\\bestList.vue"],"sourcesContent":["<style src=\"../assets/css/bestList.css\"></style>\r\n\r\n<template>\r\n  <GnbBar ref=\"childComponent\" />\r\n  <div class=\"best\">\r\n    <div class=\"best_header\">\r\n      <h2>BEST</h2>\r\n    </div>\r\n    <div class=\"best_items\">\r\n      <div v-for=\"(item, i) in bestListData\" :key=\"i\" class=\"best_item\">\r\n        <div class=\"best_item_img\">\r\n          <a href=\"\"><img :src=\"item.BOOK_COVER\" alt=\"\" /></a>\r\n        </div>\r\n        <div class=\"best_item_info\">\r\n          <h2 class=\"best_item_info_title\">\r\n            <router-link :to=\"{ name: 'bookDetail', params: { bookNum: item.BOOK_ID } }\">\r\n              {{ item.BOOK_TITLE }}\r\n            </router-link>\r\n          </h2>\r\n          <span class=\"best_item_info_author\">{{ item.BOOK_AUTHOR }} | {{ item.BOOK_PUBDATE }}</span>\r\n          <div class=\"best_item_info_price\">\r\n            <span>{{ formatNumber(item.BOOK_PRICE) }}</span>\r\n            <span>원</span>\r\n          </div>\r\n          <p class=\"best_item_info_summary\">\r\n            {{ item.BOOK_DESCRIPTION }}\r\n          </p>\r\n          <div class=\"best_item_info_star\">\r\n            <span v-if=\"item.reviewpoint == 0\" class=\"best_item_info_star_num\">0.0</span>\r\n            <span v-else class=\"best_item_info_star_num\">{{ formatReviewScore(item.reviewpoint) }}</span>\r\n            <StarIcon :rating=\"convertRatingToHalfStars(reviewScore[i])\" />\r\n          </div>\r\n        </div>\r\n        <div class=\"best_item_order\">\r\n          <a href=\"\">결제하러 가기</a>\r\n          <p><span>내일(7/28)</span> 도착예정</p>\r\n        </div>\r\n        <div class=\"best_item_btn\">\r\n          <img v-if=\"item.isLiked == true\" @click=\"likeToggle(item.BOOK_ID)\" src=\"../assets/img/heartFill.png\"\r\n            alt=\"Heart Filled\" />\r\n          <img v-else-if=\"item.isLiked == false\" @click=\"likeToggle(item.BOOK_ID)\" src=\"../assets/img/heart.png\"\r\n            alt=\"Heart\" />\r\n          <img @click=\"addToCart(item.BOOK_ID)\" src=\"../assets/img/cart2.png\" alt=\"\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!-- 플로팅-->\r\n    <Floating />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport GnbBar from \"../components/gnbBar.vue\";\r\nimport Floating from \"../components/floating.vue\"\r\nimport StarIcon from \"../components/star.vue\"; // 별점 아이콘 컴포넌트의 경로를 수정해주세요.\r\n\r\nimport axios from \"axios\";\r\naxios.defaults.baseURL = \"http://localhost:3000\";\r\naxios.defaults.headers.post[\"Contents-Type\"] = \"application/json;charset=utf-8\";\r\naxios.defaults.headers.post[\"Access-Control-Allow-Origin\"] = \"*\";\r\n\r\nexport default {\r\n\r\n  name: \"\",\r\n  components: { GnbBar, StarIcon, Floating },\r\n  data() {\r\n    return {\r\n      bestListData: [],\r\n      reviewScore: [], // 리뷰 점수를 얻어온다고 가정\r\n      email: \"\",\r\n      bookId: \"\",\r\n\r\n      //좋아요 여부\r\n      isLiked: false,\r\n      likeBook: [],\r\n    };\r\n  },\r\n\r\n  setup() { },\r\n  created() {\r\n    this.email = localStorage.getItem(\"userID\");\r\n    this.getLikeBook();\r\n    this.getBestList();\r\n  },\r\n  mounted() { },\r\n  unmounted() { },\r\n\r\n  methods: {\r\n    async getBestList() {\r\n      await axios({\r\n        url: \"http://localhost:3000/booklist/getBest\",\r\n        method: \"POST\",\r\n        data: {\r\n        }\r\n      })\r\n        .then((res) => {\r\n          if (localStorage.getItem(\"userID\")) {\r\n            this.bestListData = res.data.map(book => {\r\n              return {\r\n                ...book,\r\n                isLiked: this.likeBook.includes(book.BOOK_ID) // 해당 책의 BOOK_ID가 likeBook 배열에 포함되어 있는지 확인하여 isLiked 값을 설정\r\n              };\r\n            });\r\n            for (var i in res.data) {\r\n              //별이 5개이므로 총점10점을 2로 나눔\r\n              this.reviewScore.push((res.data[i].reviewpoint) / 2)\r\n            }\r\n          } else {\r\n            this.bestListData = res.data.map(book => {\r\n              return {\r\n                ...book,\r\n                isLiked: false // 해당 책의 BOOK_ID가 likeBook 배열에 포함되어 있는지 확인하여 isLiked 값을 설정\r\n              };\r\n            });\r\n            for (var i in res.data) {\r\n              this.bestListData.push(res.data[i]);\r\n              //별이 5개이므로 총점10점을 2로 나눔\r\n              this.reviewScore.push((res.data[i].reviewpoint) / 2)\r\n            }\r\n          }\r\n\r\n          console.log(this.bestListData)\r\n\r\n        })\r\n        .catch((err) => {\r\n          alert(err);\r\n        });\r\n    },\r\n    //회원이 좋아요한 책 ID 가져오기\r\n    async getLikeBook() {\r\n      await axios({\r\n        url: \"http://localhost:3000/bookList/checkLikeList\",\r\n        method: \"POST\",\r\n        data: {\r\n          email: this.email\r\n        }\r\n      })\r\n        .then((res) => {\r\n          this.likeBook = res.data;\r\n        })\r\n    },\r\n    async likeToggle(bookId) {\r\n      if (localStorage.getItem(\"userID\")) {\r\n        this.bookId = bookId;\r\n        await axios({\r\n          url: \"http://localhost:3000/detail/likeOrDislike\",\r\n          method: \"POST\",\r\n          data: {\r\n            email: this.email,\r\n            bookId: this.bookId\r\n          }\r\n        })\r\n          .then((res) => {\r\n            console.log(res.data, \"좋아요 추가삭제\")\r\n            this.getLikeBook();\r\n            this.getBestList();\r\n          })\r\n\r\n      } else {\r\n        const conResult = confirm(\"로그인이 필요합니다. \\n 로그인 하시겠습니까?\");\r\n        conResult ? window.location.href = \"/login\" : null;\r\n      }\r\n\r\n    },\r\n    //입력된 숫자를 주어진 범위에 따라 적절한 별점으로 변환\r\n    convertRatingToHalfStars(number) {\r\n      if (Number.isInteger(number)) {\r\n        if (number >= 1 && number <= 5) {\r\n          return number;\r\n        } else {\r\n          return 0; // 범위를 벗어나는 경우\r\n        }\r\n      } else {\r\n        const integerPart = Math.floor(number);\r\n        const decimalPart = number - integerPart;\r\n\r\n        if (decimalPart < 0.5) {\r\n          return integerPart;\r\n        } else {\r\n          return integerPart + 0.5;\r\n        }\r\n      }\r\n    },\r\n    formatReviewScore(number) {\r\n      if (Number.isInteger(number)) {\r\n        return number.toFixed(1); // 정수인 경우 소수점 자리를 1로 설정하여 변환\r\n      } else {\r\n        return number.toString(); // 소수인 경우 그대로 문자열로 변환\r\n      }\r\n    },\r\n    formatNumber(number) {\r\n      // 숫자를 천 단위마다 쉼표가 있는 형식으로 변환\r\n      return new Intl.NumberFormat().format(number);\r\n    },\r\n    //장바구니에 추가\r\n    async addToCart(bookId) {\r\n      if (localStorage.getItem(\"userID\")) {\r\n        this.bookId = bookId;\r\n        await axios({\r\n          url: \"http://localhost:3000/detail/gotoCart\",\r\n          method: \"POST\",\r\n          data: {\r\n            email: this.email,\r\n            bookId: this.bookId\r\n          }\r\n        })\r\n          .then((res) => {\r\n            alert(\"장바구니에 추가되었습니다.\");\r\n            this.$refs.childComponent.getCartNum();\r\n          })\r\n      } else {\r\n        const conResult = confirm(\"로그인이 필요합니다. \\n 로그인 하시겠습니까?\");\r\n        conResult ? window.location.href = \"/login\" : null;\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}